<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title th:text="${commandeName}"></title>
</head>
<body>

<p th:if="${isPurchased}"> Commande passée ! </p>

<table style="border: solid 1px black;">
  <thead>
    <tr>
      <th>Libelle</th>
      <th>Prix U (€)</th>
      <th>Quantité</th>
      <th>Prix (€)</th>
      <th th:if="${!isPurchased}">Action</th>
    </tr>
  </thead>
  <tbody th:each="ligne : ${lignes}">
    <tr>
      <td><p th:text="${ligne.libelle}"></p></td>
      <td><p th:text="${ligne.prixU}"></p></td>
      <td><p th:text="${ligne.quantite}"></p></td>
      <td><p th:text="${ligne.quantite * ligne.prixU}"></p></td>
      <td><form action="/store/commande/lignes/delete"
                method="POST" th:if="${!isPurchased}">
        <input type="hidden" name="ligneId" th:value="${ligne.id}" />
        <input type="hidden" name="commandeId" th:value="${commandeId}" />
        <button type="SUBMIT">❌</button>
      </form></td>
    </tr>
  </tbody>
</table>
<p>Prix total : <span th:text="${totalPrice}"></span></p>

<div class="forms" th:if="${!isPurchased}">
<form action="/store/commande/lignes"
      method="POST">
  Libelle <input name="libelle" required>
  Quantite <input type=number name="quantite" required>
  Prix U <input type=number step="0.01" name="prixU" required>
  <input type="SUBMIT">
  <input type="hidden" name="commandeId" th:value="${commandeId}" />
</form>

<form action="/store/commande/submit" method="POST">
  <input type="hidden" name="commandeId" th:value="${commandeId}" />
  <button type="submit">Passer la commande</button>
</form>
</div>

<a href="/store/dashboard">Retour</a>
</body>
</html>